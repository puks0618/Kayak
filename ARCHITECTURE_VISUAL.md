# Kayak Microservices Architecture - Visual Guide

## ğŸ—ï¸ System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Web Client     â”‚              â”‚  Admin Portal    â”‚         â”‚
â”‚  â”‚  (React + Vite)  â”‚              â”‚  (React + Vite)  â”‚         â”‚
â”‚  â”‚  Port: 5173      â”‚              â”‚  Port: 5174      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                                  â”‚                   â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                          â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API GATEWAY LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚              â”‚      API Gateway           â”‚                      â”‚
â”‚              â”‚    (Express/Fastify)       â”‚                      â”‚
â”‚              â”‚      Port: 3000            â”‚                      â”‚
â”‚              â”‚                            â”‚                      â”‚
â”‚              â”‚  â€¢ Rate Limiting           â”‚                      â”‚
â”‚              â”‚  â€¢ JWT Verification        â”‚                      â”‚
â”‚              â”‚  â€¢ Request Routing         â”‚                      â”‚
â”‚              â”‚  â€¢ Logging                 â”‚                      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                        â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚                â”‚
        â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MICROSERVICES LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Auth   â”‚  â”‚   User   â”‚  â”‚ Listing  â”‚  â”‚  Search  â”‚        â”‚
â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚        â”‚
â”‚  â”‚ :3001    â”‚  â”‚ :3002    â”‚  â”‚ :3003    â”‚  â”‚ :3004    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚             â”‚             â”‚              â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Booking  â”‚  â”‚Analytics â”‚ â”‚  Admin   â”‚  â”‚ AI Agent â”‚        â”‚
â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚ â”‚ Service  â”‚  â”‚(FastAPI) â”‚        â”‚
â”‚  â”‚ :3005    â”‚  â”‚ :3006    â”‚ â”‚ :3007    â”‚  â”‚ :8000    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚             â”‚             â”‚              â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MESSAGING LAYER (Kafka)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚              â”‚    Apache Kafka :9092      â”‚                      â”‚
â”‚              â”‚                            â”‚                      â”‚
â”‚              â”‚  Topics:                   â”‚                      â”‚
â”‚              â”‚  â€¢ user.created            â”‚                      â”‚
â”‚              â”‚  â€¢ listing.created         â”‚                      â”‚
â”‚              â”‚  â€¢ booking.created         â”‚                      â”‚
â”‚              â”‚  â€¢ payment.initiated       â”‚                      â”‚
â”‚              â”‚  â€¢ admin.command           â”‚                      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚
        â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CACHE LAYER     â”‚      â”‚  DATABASE LAYER  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚      â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Redis    â”‚ â”‚      â”‚  â”‚   MySQL    â”‚  â”‚
â”‚  â”‚   :6379    â”‚ â”‚      â”‚  â”‚ (AWS RDS)  â”‚  â”‚
â”‚  â”‚            â”‚ â”‚      â”‚  â”‚   :3306    â”‚  â”‚
â”‚  â”‚ â€¢ Sessions â”‚ â”‚      â”‚  â”‚            â”‚  â”‚
â”‚  â”‚ â€¢ Cache    â”‚ â”‚      â”‚  â”‚ DBs:       â”‚  â”‚
â”‚  â”‚ â€¢ Rate     â”‚ â”‚      â”‚  â”‚ â€¢ auth     â”‚  â”‚
â”‚  â”‚   Limits   â”‚ â”‚      â”‚  â”‚ â€¢ users    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚  â”‚ â€¢ listings â”‚  â”‚
â”‚                  â”‚      â”‚  â”‚ â€¢ bookings â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                          â”‚                  â”‚
                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                          â”‚  â”‚  MongoDB   â”‚  â”‚
                          â”‚  â”‚ (DocumentDB)â”‚ â”‚
                          â”‚  â”‚  :27017    â”‚  â”‚
                          â”‚  â”‚            â”‚  â”‚
                          â”‚  â”‚ â€¢ reviews  â”‚  â”‚
                          â”‚  â”‚ â€¢ images   â”‚  â”‚
                          â”‚  â”‚ â€¢ logs     â”‚  â”‚
                          â”‚  â”‚ â€¢ analyticsâ”‚  â”‚
                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Your Focus: Listing Service (Flights Module)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LISTING SERVICE (Port 3003)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Entry Point: server.js                                          â”‚
â”‚  â”œâ”€ Mounts routes:                                               â”‚
â”‚  â”‚  â”œâ”€ /api/listings/flights  â†’ Flight Routes                    â”‚
â”‚  â”‚  â”œâ”€ /api/listings/hotels   â†’ Hotel Routes                     â”‚
â”‚  â”‚  â””â”€ /api/listings/cars     â†’ Car Routes                       â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€ Initializes:                                                 â”‚
â”‚     â”œâ”€ Redis Cache Connection                                    â”‚
â”‚     â”œâ”€ MySQL Connection                                          â”‚
â”‚     â”œâ”€ MongoDB Connection                                        â”‚
â”‚     â””â”€ Kafka Producers/Consumers                                 â”‚
â”‚                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    FLIGHTS MODULE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  route.js (API Endpoints)                            â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚
â”‚  â”‚  â”‚ GET    /api/listings/flights                   â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ GET    /api/listings/flights/:id               â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ POST   /api/listings/flights                   â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ PATCH  /api/listings/flights/:id               â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ DELETE /api/listings/flights/:id               â”‚  â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                      â”‚                                           â”‚
â”‚                      â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  controller.js (Business Logic)                      â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚
â”‚  â”‚  â”‚ getAll()    - Fetch flights with filters      â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ getById()   - Get single flight + reviews     â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ create()    - Create new flight + publish evt â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ update()    - Update flight + invalidate cacheâ”‚ â”‚       â”‚
â”‚  â”‚  â”‚ delete()    - Delete flight + publish event   â”‚  â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                      â”‚                                           â”‚
â”‚                      â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  model.js (Database Operations)                      â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚
â”‚  â”‚  â”‚ create()    - INSERT INTO flights              â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ findAll()   - SELECT with WHERE filters        â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ findById()  - SELECT by ID                     â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ update()    - UPDATE flights SET ...           â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ delete()    - DELETE FROM flights              â”‚  â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                      â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ MySQL  â”‚    â”‚ MongoDB â”‚    â”‚ Redis  â”‚
   â”‚ flightsâ”‚    â”‚ reviews â”‚    â”‚ Cache  â”‚
   â”‚ table  â”‚    â”‚collectionâ”‚   â”‚        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow: Creating a Flight

```
1. Admin Portal
   â”‚
   â”‚ POST /api/listings/flights
   â”‚ Body: { flight_code: "AA123", ... }
   â”‚
   â–¼
2. API Gateway (Port 3000)
   â”‚
   â”‚ â€¢ Verify JWT token
   â”‚ â€¢ Check rate limits
   â”‚ â€¢ Add request ID
   â”‚ â€¢ Log request
   â”‚
   â–¼
3. Listing Service (Port 3003)
   â”‚
   â”‚ route.js receives request
   â”‚
   â–¼
4. controller.js
   â”‚
   â”‚ â€¢ Validate input
   â”‚ â€¢ Call model.create()
   â”‚
   â–¼
5. model.js
   â”‚
   â”‚ â€¢ Generate UUID
   â”‚ â€¢ Execute SQL INSERT
   â”‚
   â–¼
6. MySQL Database
   â”‚
   â”‚ â€¢ Insert into flights table
   â”‚ â€¢ Return new flight data
   â”‚
   â–¼
7. Back to controller.js
   â”‚
   â”‚ â€¢ Publish Kafka event (listing.created)
   â”‚ â€¢ Return response
   â”‚
   â–¼
8. Kafka
   â”‚
   â”‚ â€¢ Broadcast event to subscribers
   â”‚ â€¢ Analytics Service listens
   â”‚ â€¢ Search Service listens
   â”‚
   â–¼
9. Response to Admin Portal
   â”‚
   â”‚ { message: "Flight created", flight: {...} }
   â”‚
   âœ“ Done!
```

---

## ğŸ” Data Flow: Searching for Flights

```
1. Web Client
   â”‚
   â”‚ GET /api/listings/flights?origin=SFO&destination=JFK&date=2025-12-15
   â”‚
   â–¼
2. API Gateway
   â”‚
   â”‚ â€¢ Log request
   â”‚ â€¢ Forward to Listing Service
   â”‚
   â–¼
3. Listing Service
   â”‚
   â”‚ route.js â†’ controller.getAll()
   â”‚
   â–¼
4. Check Redis Cache
   â”‚
   â”‚ Key: "flights:SFO:JFK:2025-12-15"
   â”‚
   â”œâ”€ Cache HIT? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Return cached data       â”‚
   â”‚                           â”‚
   â””â”€ Cache MISS?              â”‚
      â”‚                        â”‚
      â–¼                        â”‚
5. Query MySQL                 â”‚
   â”‚                           â”‚
   â”‚ SELECT * FROM flights     â”‚
   â”‚ WHERE departure_airport = 'SFO'
   â”‚   AND arrival_airport = 'JFK'
   â”‚   AND DATE(departure_time) = '2025-12-15'
   â”‚                           â”‚
   â–¼                           â”‚
6. Store in Redis Cache        â”‚
   â”‚                           â”‚
   â”‚ SET with 1 hour TTL       â”‚
   â”‚                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
7. Return to Web Client
   â”‚
   â”‚ { flights: [...], total: 5 }
   â”‚
   âœ“ Done!
```

---

## ğŸ”„ Data Flow: Getting Flight Details with Reviews

```
1. Web Client
   â”‚
   â”‚ GET /api/listings/flights/abc-123-def
   â”‚
   â–¼
2. API Gateway â†’ Listing Service
   â”‚
   â–¼
3. controller.getById()
   â”‚
   â”œâ”€ Check Redis Cache
   â”‚  Key: "flight:abc-123-def"
   â”‚
   â”œâ”€ If MISS:
   â”‚  â”‚
   â”‚  â”œâ”€ Query MySQL
   â”‚  â”‚  SELECT * FROM flights WHERE id = 'abc-123-def'
   â”‚  â”‚
   â”‚  â”œâ”€ Query MongoDB
   â”‚  â”‚  db.reviews.find({ listing_id: 'abc-123-def' })
   â”‚  â”‚
   â”‚  â”œâ”€ Combine data
   â”‚  â”‚  flight.reviews = reviews
   â”‚  â”‚
   â”‚  â””â”€ Cache result
   â”‚     redis.set("flight:abc-123-def", JSON.stringify(flight), 3600)
   â”‚
   â–¼
4. Return combined data
   â”‚
   â”‚ {
   â”‚   id: "abc-123-def",
   â”‚   flight_code: "AA123",
   â”‚   airline: "American Airlines",
   â”‚   price: 450.00,
   â”‚   reviews: [
   â”‚     { rating: 4.5, comment: "Great flight!" },
   â”‚     { rating: 5.0, comment: "Excellent service" }
   â”‚   ]
   â”‚ }
   â”‚
   âœ“ Done!
```

---

## ğŸ“Š Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MySQL (AWS RDS)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Database: kayak_users                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  users               â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ id (PK)          â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ email            â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ password_hash    â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ first_name       â”‚                                        â”‚
â”‚  â”‚  â””â”€ ...              â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚             â”‚                                                     â”‚
â”‚             â”‚ Referenced by                                      â”‚
â”‚             â”‚                                                     â”‚
â”‚  Database: kayak_listings                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  flights             â”‚  â”‚  hotels          â”‚                 â”‚
â”‚  â”‚  â”œâ”€ id (PK)          â”‚  â”‚  â”œâ”€ id (PK)      â”‚                 â”‚
â”‚  â”‚  â”œâ”€ flight_code      â”‚  â”‚  â”œâ”€ name         â”‚                 â”‚
â”‚  â”‚  â”œâ”€ airline          â”‚  â”‚  â”œâ”€ city         â”‚                 â”‚
â”‚  â”‚  â”œâ”€ departure_airportâ”‚  â”‚  â”œâ”€ price        â”‚                 â”‚
â”‚  â”‚  â”œâ”€ arrival_airport  â”‚  â”‚  â””â”€ ...          â”‚                 â”‚
â”‚  â”‚  â”œâ”€ price            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚  â”‚  â””â”€ ...              â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚             â”‚              â”‚  cars            â”‚                 â”‚
â”‚             â”‚              â”‚  â”œâ”€ id (PK)      â”‚                 â”‚
â”‚             â”‚              â”‚  â”œâ”€ type         â”‚                 â”‚
â”‚             â”‚              â”‚  â”œâ”€ price        â”‚                 â”‚
â”‚             â”‚              â”‚  â””â”€ ...          â”‚                 â”‚
â”‚             â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚             â”‚                                                     â”‚
â”‚             â”‚ Referenced by                                      â”‚
â”‚             â”‚                                                     â”‚
â”‚  Database: kayak_bookings                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  bookings            â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ id (PK)          â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ user_id (FK)     â”‚â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚  â”œâ”€ listing_id (FK)  â”‚â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  â”‚  â”œâ”€ status           â”‚                                        â”‚
â”‚  â”‚  â””â”€ total_amount     â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚             â”‚                                                     â”‚
â”‚             â”‚ Referenced by                                      â”‚
â”‚             â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  billing             â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ id (PK)          â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ booking_id (FK)  â”‚                                        â”‚
â”‚  â”‚  â”œâ”€ amount           â”‚                                        â”‚
â”‚  â”‚  â””â”€ status           â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MongoDB (DocumentDB)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Database: kayak_listings                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  reviews             â”‚                                        â”‚
â”‚  â”‚  {                   â”‚                                        â”‚
â”‚  â”‚    _id: ObjectId     â”‚                                        â”‚
â”‚  â”‚    listing_id: "..." â”‚â”€â”€â”€â” References flights.id             â”‚
â”‚  â”‚    user_id: "..."    â”‚â”€â”€â”€â”˜ References users.id               â”‚
â”‚  â”‚    rating: 4.5       â”‚                                        â”‚
â”‚  â”‚    comment: "..."    â”‚                                        â”‚
â”‚  â”‚    created_at: Date  â”‚                                        â”‚
â”‚  â”‚  }                   â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  images              â”‚                                        â”‚
â”‚  â”‚  {                   â”‚                                        â”‚
â”‚  â”‚    _id: ObjectId     â”‚                                        â”‚
â”‚  â”‚    listing_id: "..." â”‚â”€â”€â”€â” References flights/hotels/cars.id â”‚
â”‚  â”‚    url: "..."        â”‚                                        â”‚
â”‚  â”‚    caption: "..."    â”‚                                        â”‚
â”‚  â”‚  }                   â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”‚  Database: kayak_analytics                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  analytics           â”‚                                        â”‚
â”‚  â”‚  {                   â”‚                                        â”‚
â”‚  â”‚    _id: ObjectId     â”‚                                        â”‚
â”‚  â”‚    date: Date        â”‚                                        â”‚
â”‚  â”‚    type: "revenue"   â”‚                                        â”‚
â”‚  â”‚    metrics: {...}    â”‚                                        â”‚
â”‚  â”‚  }                   â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â”‚  Database: kayak_logs                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  application_logs    â”‚ (Capped Collection)                   â”‚
â”‚  â”‚  {                   â”‚                                        â”‚
â”‚  â”‚    service: "..."    â”‚                                        â”‚
â”‚  â”‚    level: "info"     â”‚                                        â”‚
â”‚  â”‚    message: "..."    â”‚                                        â”‚
â”‚  â”‚    timestamp: Date   â”‚                                        â”‚
â”‚  â”‚  }                   â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authentication Flow

```
1. User Login
   â”‚
   â”‚ POST /api/auth/login
   â”‚ Body: { email, password }
   â”‚
   â–¼
2. Auth Service
   â”‚
   â”‚ â€¢ Verify credentials
   â”‚ â€¢ Generate JWT token
   â”‚
   â–¼
3. Return JWT
   â”‚
   â”‚ { token: "eyJhbGc..." }
   â”‚
   â–¼
4. Client stores token
   â”‚
   â”‚ localStorage.setItem('token', token)
   â”‚
   â–¼
5. Subsequent requests
   â”‚
   â”‚ Headers: { Authorization: "Bearer eyJhbGc..." }
   â”‚
   â–¼
6. API Gateway
   â”‚
   â”‚ â€¢ Verify JWT
   â”‚ â€¢ Extract user_id
   â”‚ â€¢ Forward to service
   â”‚
   â–¼
7. Service receives request
   â”‚
   â”‚ req.user = { id: "...", email: "..." }
   â”‚
   âœ“ Authenticated!
```

---

## ğŸ“¡ Kafka Event Flow

```
Producer (Listing Service)
   â”‚
   â”‚ Flight created: { id: "...", airline: "...", price: 450 }
   â”‚
   â–¼
Kafka Topic: listing.created
   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚             â”‚             â”‚             â”‚
   â–¼             â–¼             â–¼             â–¼
Analytics    Search       AI Agent      Logging
Service      Service                    Service
   â”‚             â”‚             â”‚             â”‚
   â”‚             â”‚             â”‚             â”‚
   â–¼             â–¼             â–¼             â–¼
Update       Index in      Analyze       Write
MongoDB      cache/ES      for deals     to logs
analytics    for fast                    collection
             search
```

---

## ğŸ¯ Your Implementation Map

```
YOU ARE HERE: Listing Service â†’ Flights Module
              â””â”€ controller.js (line 37, 57)

WHAT YOU NEED TO CONNECT TO:

1. MongoDB (for reviews)
   â”œâ”€ Import: shared/database/mongodb.js
   â”œâ”€ Connect to: kayak_listings database
   â””â”€ Query: reviews collection

2. Redis (for caching)
   â”œâ”€ Import: cache/redis.js
   â”œâ”€ Operations: get(), set(), del()
   â””â”€ Keys: "flight:{id}", "flights:{filters}"

3. Kafka (for events)
   â”œâ”€ Import: events/producers/listing.producer.js
   â”œâ”€ Topics: listing.created, listing.updated, listing.deleted
   â””â”€ Publish when: create, update, delete operations

4. MySQL (already connected)
   â”œâ”€ Connection: model.js (already done)
   â”œâ”€ Database: kayak_listings
   â””â”€ Table: flights
```

---

## ğŸš€ Quick Reference: Ports & URLs

| Service | Port | URL | Your Work? |
|---------|------|-----|------------|
| API Gateway | 3000 | http://localhost:3000 | No |
| Auth Service | 3001 | http://localhost:3001 | No |
| User Service | 3002 | http://localhost:3002 | No |
| **Listing Service** | **3003** | **http://localhost:3003** | **YES!** |
| Search Service | 3004 | http://localhost:3004 | No |
| Booking Service | 3005 | http://localhost:3005 | No |
| Analytics Service | 3006 | http://localhost:3006 | No |
| Admin Service | 3007 | http://localhost:3007 | No |
| AI Agent | 8000 | http://localhost:8000 | No |
| MySQL | 3306 | localhost:3306 | Read/Write |
| MongoDB | 27017 | localhost:27017 | Read/Write |
| Redis | 6379 | localhost:6379 | Read/Write |
| Kafka | 9092 | localhost:9092 | Publish |
| Web Client | 5173 | http://localhost:5173 | Test UI |
| Admin Portal | 5174 | http://localhost:5174 | Test UI |

---

## ğŸ’¡ Key Takeaways

1. **Your service is one piece** of a larger system
2. **Data flows through multiple layers** (Client â†’ Gateway â†’ Service â†’ Database)
3. **Events connect services** (Kafka broadcasts changes)
4. **Caching improves performance** (Redis reduces database load)
5. **Multiple databases serve different purposes** (MySQL for structure, MongoDB for flexibility)

---

**Now you understand the big picture! Focus on your piece (Flights Module) and how it connects to the rest. ğŸ¯**

